# DoseScheduleScreen Improvement Proposal

## Overview

투여 스케줄 화면을 가비움 디자인 시스템과 일치시켜 브랜드 일관성을 확보하고, 상태별 시각적 계층 구조를 명확히 하며, 의료앱으로서의 신뢰감과 친근함을 강화하는 UI 개선입니다.

---

## Current State Issues

### Brand Consistency Issues

- **Issue 1: 비표준 색상 팔레트 사용**
  - 문제: Material Design 색상(green.shade50~700, red.shade, blue.shade, amber.shade)을 직접 사용
  - 영향: 가비움 디자인 시스템과 단절, 앱 전체 시각적 일관성 훼손

- **Issue 2: 상태별 색상이 직관적이지 못함**
  - 문제: 완료(초록) vs 진행(파랑) vs 예정(주황)의 의미 구분 불명확
  - 영향: 사용자가 상태를 즉시 파악하기 어려움

### Visual Quality Issues

- **Issue 3: 타이포그래피 계층 불명확**
  - 문제: 제목(titleMedium), 부제목(bodySmall), 라벨 간의 시각적 구분 약함
  - 영향: 정보 우선순위가 명확하지 않아 스캔 어려움

- **Issue 4: 여백(Spacing) 일관성 미흡**
  - 문제: margin 12px, padding 16px/12px 등 다양하고 불규칙함
  - 영향: 깔끔한 리듬감 부족, 프로페셔널하지 못한 느낌

- **Issue 5: 상태 배지의 시각적 강도 부족**
  - 문제: "완료됨", "오늘" 텍스트만으로 상태 전달
  - 영향: 가비움의 뱃지/배지 시스템 미활용

### UX Issues

- **Issue 6: Empty State의 단순한 디자인**
  - 문제: 아이콘 + 텍스트 구성이 기본적이고, 정보계층이 없음
  - 영향: 사용자 동기 부여 약함, 다음 액션 제시 부족

- **Issue 7: Dialog의 시각적 구분 약함**
  - 문제: 표준 AlertDialog 사용으로 앱 스타일과 부조화
  - 영향: 다이얼로그 컨텐츠가 덜 중요해 보임

- **Issue 8: 상태 전환의 시각적 피드백 부족**
  - 문제: 버튼 클릭, 로딩 중, 완료 등의 피드백이 단순함
  - 영향: 사용자가 작업 진행 상황을 인지하기 어려움

---

## Improvement Direction

### Change 1: 상태별 색상 시스템을 가비움 의미 색상으로 통일

**Current:** 완료(green.shade50/300/700), 연체(red.shade), 오늘(blue.shade), 예정(amber.shade) 등 Material 색상

**Proposed:**
- 완료된 투여 → Success: `#10B981` (Emerald-500)
- 연체된 투여 → Error: `#EF4444` (Red-500)
- 오늘 투여 → Warning: `#F59E0B` (Amber-500)
- 예정된 투여 → Info: `#3B82F6` (Blue-500)

**Rationale:**
- 의미론적 색상 사용으로 사용자가 상태를 직관적으로 파악
- 가비움 시맨틱 색상 시스템과 일치하여 브랜드 일관성 강화
- WCAG AA 접근성 기준 충족

**Design System Mapping:**
- Component: Semantic Color System (Section 3)
- Success: `#10B981` (Emerald-500)
- Error: `#EF4444` (Red-500)
- Warning: `#F59E0B` (Amber-500)
- Info: `#3B82F6` (Blue-500)
- Interactive States: 각 의미별 색상의 상태 변화 정의

---

### Change 2: 카드 컨테이너를 가비움 Card 컴포넌트로 표준화

**Current:**
```
Container(
  margin: EdgeInsets.only(bottom: 12)
  border: Border.all(color: borderColor)
  borderRadius: 8
)
```

**Proposed:**
- Background: `#FFFFFF`
- Border: 1px solid `#E2E8F0` (Neutral-200) OR no border with shadow
- Border Radius: 12px (md)
- Shadow: sm (default), md (on hover/important)
- Padding: 16px (mobile)
- Spacing: 16px between cards
- Hover State: Shadow md, 2px lift (translateY(-2px))

**Rationale:**
- Design System의 Card 패턴 재사용으로 개발 효율성 증대
- 일관된 여백과 그림자로 프로페셔널한 느낌
- 상호작용 피드백(hover) 추가로 반응성 강화

**Design System Mapping:**
- Component: Card Container (Section 7 - Layout Patterns)
- Background: `#FFFFFF`
- Border: 1px solid `#E2E8F0` (Neutral-200)
- Border Radius: 12px (md)
- Shadow: sm (0 2px 4px rgba(15, 23, 42, 0.06))
- Padding: 16px
- Spacing: 16px between cards
- Hover: Shadow md, Transform translateY(-2px)

---

### Change 3: 타이포그래피 계층을 가비움 Type Scale로 강화

**Current:**
- title: titleMedium (Theme default, 명확하지 않음)
- subtitle: bodySmall (14px, 부제목에 부적절)
- label: labelLarge (Theme default)

**Proposed:**
- Dose Amount (투여량): xl (20px, Semibold) - 가장 중요한 정보
- Scheduled Date (예정 날짜): base (16px, Regular) - 기본 정보
- Status Badge (상태): sm (14px, Medium) - 보조 정보
- Empty State Title: lg (18px, Semibold)
- Empty State Description: base (16px, Regular)
- Dialog Title: 2xl (24px, Bold)
- Dialog Content: base (16px, Regular)
- Dialog Label: sm (14px, Semibold)

**Rationale:**
- 명확한 타이포그래피 계층으로 정보 스캔 시간 단축
- 가비움 Type Scale 재사용으로 일관성 확보
- 시각적 무게감이 정보 중요도와 일치

**Design System Mapping:**
- Component: Typography (Section 4 - Type Scale)
- 3xl: 28px, Bold (페이지 주 제목)
- 2xl: 24px, Bold (섹션 제목, 모달 제목)
- xl: 20px, Semibold (하위 섹션 제목, 카드 제목)
- base: 16px, Regular (본문, 기본 UI 텍스트)
- sm: 14px, Regular (보조 텍스트, 라벨)

---

### Change 4: 상태 표시를 아이콘 + 배지 조합으로 개선

**Current:**
- 완료: "완료됨" 텍스트 + check_circle 아이콘
- 연체: "warning" 아이콘만
- 진행 중: 없음
- 예정: 없음

**Proposed:**
- 완료: ✓ Success 배지 (bg: `#ECFDF5`, text: `#065F46`, icon: check-circle 20px)
- 연체: ⚠ Error 배지 (bg: `#FEF2F2`, text: `#991B1B`, icon: alert-circle 20px)
- 오늘: ◐ Warning 배지 (bg: `#FFFBEB`, text: `#92400E`, icon: flag 20px)
- 예정: ○ Info 배지 (bg: `#EFF6FF`, text: `#1E40AF`, icon: clock 20px)

**Rationale:**
- 아이콘 + 색상 조합으로 즉각적 상태 인식
- 배지 시스템으로 가비움 디자인 언어 강화
- 접근성 개선 (색상 + 아이콘 + 텍스트 조합)

**Design System Mapping:**
- Component: Alert Banner / Feedback Components (Section 7)
- Success: `#ECFDF5` bg, `#065F46` text, `#10B981` border
- Error: `#FEF2F2` bg, `#991B1B` text, `#EF4444` border
- Warning: `#FFFBEB` bg, `#92400E` text, `#F59E0B` border
- Info: `#EFF6FF` bg, `#1E40AF` text, `#3B82F6` border

---

### Change 5: 버튼을 가비움 Button 컴포넌트로 표준화

**Current:**
- "기록" 버튼: ElevatedButton (기본 Material style)
- "저장" 버튼: ElevatedButton (기본 Material style)
- "취소" 버튼: TextButton

**Proposed:**
- Primary Action ("기록", "저장"): Primary Button
  - Background: `#4ADE80`
  - Text: `#FFFFFF`, Semibold (600)
  - Height: 44px (Medium)
  - Padding: 24px horizontal
  - Border Radius: 8px (sm)
  - Shadow: sm
  - States: Hover `#22C55E`, Active `#16A34A`, Disabled opacity 40%

- Secondary Action ("취소"): Secondary Button
  - Background: Transparent
  - Text: `#4ADE80`, Semibold (600)
  - Border: 2px solid `#4ADE80`
  - States: Hover bg `#4ADE80` at 8%, Active bg at 12%

**Rationale:**
- 버튼 크기/색상 표준화로 일관된 UX 제공
- Primary/Secondary 구분으로 액션 우선순위 명확화
- 시각적 계층 강화

**Design System Mapping:**
- Component: Buttons (Section 7 - Core Components)
- Primary Button: `#4ADE80` bg, `#FFFFFF` text, 44px height, 8px radius, sm shadow
- Secondary Button: Transparent bg, `#4ADE80` text, 2px border
- Sizes: Medium (44px height, 16px base text, 24px padding)

---

### Change 6: Empty State를 가비움 Empty State 패턴으로 강화

**Current:**
- Icon (48px, Colors.grey)
- Title (텍스트만)
- Description (텍스트만)

**Proposed:**
- Container: 중앙 정렬, 상하 xl (32px) 여백
- Icon: 120x120px, `#CBD5E1` (Neutral-300) 색상
- Title: lg (18px, Semibold), `#334155` (Neutral-700)
- Description: base (16px, Regular), `#64748B` (Neutral-500)
- Spacing: 24px between elements
- CTA Button: Primary or Secondary (Optional)

**Rationale:**
- 더 큰 공간으로 사용자의 주의 집중
- 충분한 여백으로 깨끗하고 현대적인 느낌
- 선택적 CTA 버튼으로 다음 액션 제시

**Design System Mapping:**
- Component: Empty State (Section 7 - Layout Patterns)
- Alignment: Center (vertical + horizontal)
- Illustration: 120x120px, `#CBD5E1`
- Title: lg (18px, Semibold), `#334155`
- Description: base (16px, Regular), `#64748B`
- Spacing: 24px (lg) between elements

---

### Change 7: Dialog를 가비움 Modal 컴포넌트로 재설계

**Current:** 표준 AlertDialog (매우 기본적임)

**Proposed:**
- Max Width: 480px (mobile: 90% viewport)
- Padding: 24px
- Border Radius: 16px (lg)
- Shadow: xl
- Backdrop: rgba(15, 23, 42, 0.5) (Neutral-900 at 50%)
- Header: Title (xl, Bold), Close button (top-right, optional)
- Body: base text, scrollable if needed, 24px padding
- Footer: Actions (right-aligned), Primary + Secondary buttons, 16px spacing
- Animation: Fade-in backdrop + Scale-up modal (200ms)

**Rationale:**
- 더 큰 패딩과 높은 corner radius로 모던한 느낌
- xl 그림자로 다이얼로그의 중요성 강조
- 명확한 구조(Header/Body/Footer)로 가독성 개선
- 애니메이션 추가로 사용자 경험 향상

**Design System Mapping:**
- Component: Modal/Dialog (Section 7 - Feedback Components)
- Max Width: 480px (mobile: 90%)
- Padding: 24px
- Border Radius: 16px (lg)
- Shadow: xl (0 16px 32px rgba(15, 23, 42, 0.12))
- Backdrop: rgba(15, 23, 42, 0.5)
- Animation: Fade + Scale-up (200ms, cubic-bezier(0.4, 0, 0.2, 1))
- Title: xl (20px, Semibold)
- Content: base (16px, Regular)

---

### Change 8: 여백(Spacing) 시스템을 가비움 Spacing Scale로 통일

**Current:** 불규칙한 여백 (margin 12px, padding 16px/12px 등)

**Proposed:**
- 카드 간 여백: 16px (md)
- 카드 내부 패딩: 16px (md)
- 섹션 간 여백: 24px (lg)
- 페이지 상하 여백: 32px (xl)
- 요소 간 간격: 16px (md) 또는 8px (sm)
- 텍스트-아이콘 간: 4px (xs) 또는 8px (sm)

**Rationale:**
- 8px 기반 시스템으로 디자인-개발 정합성 강화
- 일관된 리듬감으로 깔끔함 전달
- 타이포그래피와 함께 명확한 정보 계층 구성

**Design System Mapping:**
- Component: Spacing & Sizing (Section 5)
- xs: 4px (텍스트-아이콘 간격)
- sm: 8px (컴포넌트 내부 패딩)
- md: 16px (기본 요소 간 간격)
- lg: 24px (섹션 간 간격)
- xl: 32px (주요 섹션 구분)

---

### Change 9: 로딩 상태의 시각적 강화

**Current:** CircularProgressIndicator (기본 Material style)

**Proposed:**
- 풀페이지 로딩: 48px spinner, `#4ADE80` (Primary)
- 버튼 내 로딩: 16px spinner, `#FFFFFF`
- 애니메이션: 1s linear infinite rotation
- 로딩 텍스트: "저장 중..." (선택적)

**Rationale:**
- 가비움 Primary 색상으로 브랜드 일관성
- 적절한 크기로 시각적 피드백 강화
- 다양한 상황에 대응하는 로딩 상태 정의

**Design System Mapping:**
- Component: Loading Indicator (Section 7 - Feedback Components)
- Color: `#4ADE80` (Primary)
- Sizes: Large 48px (full-page), Medium 24px (buttons)
- Animation: 1s linear infinite rotation

---

## Design System Token Reference

Complete list of all tokens to be used:

| Element | Token Path | Value | Usage |
|---------|-----------|-------|-------|
| Success BG | Colors - Semantic - Success | `#10B981` | 완료된 투여 배경 |
| Error BG | Colors - Semantic - Error | `#EF4444` | 연체된 투여 배경 |
| Warning BG | Colors - Semantic - Warning | `#F59E0B` | 오늘 투여 배경 |
| Info BG | Colors - Semantic - Info | `#3B82F6` | 예정 투여 배경 |
| Primary | Colors - Primary | `#4ADE80` | CTA 버튼, 진행 표시 |
| Neutral-50 | Colors - Neutral - 50 | `#F8FAFC` | 앱 배경 |
| Neutral-100 | Colors - Neutral - 100 | `#F1F5F9` | 카드 배경 |
| Neutral-200 | Colors - Neutral - 200 | `#E2E8F0` | 구분선, 테두리 |
| Neutral-300 | Colors - Neutral - 300 | `#CBD5E1` | 기본 테두리 |
| Neutral-500 | Colors - Neutral - 500 | `#64748B` | 보조 텍스트 |
| Neutral-700 | Colors - Neutral - 700 | `#334155` | 본문 텍스트 |
| Neutral-800 | Colors - Neutral - 800 | `#1E293B` | 제목 텍스트 |
| Neutral-900 | Colors - Neutral - 900 | `#0F172A` | 그림자 기조 |
| Card BG | Layout - Card | `#FFFFFF` | 카드 컨테이너 |
| Card Border | Layout - Card | `#E2E8F0` | 카드 테두리 |
| Card Shadow | Layout - Card | sm (0 2px 4px rgba(0,0,0,0.06)) | 카드 그림자 |
| Heading (xl) | Typography - xl | 20px, Semibold | 카드 제목 |
| Body (base) | Typography - base | 16px, Regular | 기본 텍스트 |
| Label (sm) | Typography - sm | 14px, Regular | 라벨, 보조 텍스트 |
| Dialog Title | Typography - xl | 20px, Semibold | 다이얼로그 제목 |
| Button Primary | Buttons - Primary | `#4ADE80`, 44px, sm radius | CTA 버튼 |
| Button Secondary | Buttons - Secondary | Transparent, 2px border | 보조 액션 |
| Border Radius sm | Visual - Border Radius | 8px | 버튼, 입력 필드 |
| Border Radius md | Visual - Border Radius | 12px | 카드 |
| Border Radius lg | Visual - Border Radius | 16px | 다이얼로그 |
| Shadow sm | Visual - Shadow | 0 2px 4px rgba(15,23,42,0.06) | 버튼, 작은 카드 |
| Shadow md | Visual - Shadow | 0 4px 8px rgba(15,23,42,0.08) | 기본 카드 |
| Shadow xl | Visual - Shadow | 0 16px 32px rgba(15,23,42,0.12) | 다이얼로그 |
| Spacing md | Spacing | 16px | 기본 여백 |
| Spacing lg | Spacing | 24px | 섹션 간 여백 |
| Transition | Visual - Transitions | 200ms, cubic-bezier(0.4, 0, 0.2, 1) | 상태 전환 |

---

## Preserved Elements

What should NOT change:

- **Data Model Structure**: schedule, records, completeness 판단 로직은 유지 (비즈니스 로직)
- **List Layout**: ListView.builder 기본 구조 유지
- **Dialog Functionality**: 주사 부위 선택, 메모 입력, 저장 로직은 유지
- **Navigation Flow**: 화면 전환, 다이얼로그 열기/닫기 패턴 유지

---

## Dependencies

### Prerequisites (must do first):

✅ None - 가비움 디자인 시스템이 이미 완성되어 있음

### Impact (will need updating after):

- Home Dashboard: 같은 카드 스타일 적용 가능
- Daily Tracking Screen: 같은 색상/타이포그래피 시스템 적용
- Notification Settings Screen: 같은 버튼/배지 스타일 적용
- All screens: 여백/타이포그래피 표준화 파급 가능

---

## Component Reuse

### Existing Components to Reuse:

- GabiumButton (Primary, Secondary) - 버튼 스타일링
- GabiumTextField - 메모 입력 필드 (필요시)

### New Components to Create:

- StatusBadge - 상태 표시 배지 (Success/Error/Warning/Info 변형)
  - 아이콘 + 배경색 + 텍스트 조합
  - 44x44px 이상의 터치 영역

- DoseScheduleCard - 투여 스케줄 카드
  - 투여량, 날짜, 상태, 액션 버튼 포함
  - 가비움 Card 패턴 적용
  - Hover 상태 지원

- EmptyStateWidget - Empty State 표시
  - 아이콘(120x120px), 제목, 설명, 선택적 CTA
  - 다양한 시나리오 대응 (계획 없음, 스케줄 없음 등)

---

## Success Criteria

1. 모든 색상이 가비움 시맨틱 색상 시스템을 사용하고 있는가?
   - ✓ Success/Error/Warning/Info로 상태 표현

2. 타이포그래피가 가비움 Type Scale (3xl-xs)을 준수하는가?
   - ✓ 제목(xl), 본문(base), 라벨(sm) 명확히 구분

3. 여백이 8px 기반 시스템을 따르는가?
   - ✓ xs(4px), sm(8px), md(16px), lg(24px), xl(32px) 일관 사용

4. 모든 상호작용 요소가 44x44px 이상의 터치 영역을 확보하는가?
   - ✓ 버튼, 배지, 터치 가능한 아이콘 모두 충족

5. 접근성 기준(WCAG AA)을 만족하는가?
   - ✓ 색상 대비 4.5:1 이상 (텍스트)
   - ✓ 색상 + 아이콘 조합으로 색맹 사용자도 구분 가능

6. 사용자가 각 상태를 1초 이내에 파악할 수 있는가?
   - ✓ 색상 + 아이콘 + 배지 조합으로 즉각적 인식

---

## Technical Context

### Platform/Framework:

Flutter (Dart)

### Special Constraints:

- ✅ None

---

## Layout Structure (High-Level)

```
┌─────────────────────────────────────────┐
│ AppBar (56px)                           │
│ 투여 스케줄                             │
├─────────────────────────────────────────┤
│ ListView.builder                        │
│                                         │
│ ┌──────────────────────────────────┐   │
│ │ DoseScheduleCard                 │   │
│ │ ┌──────────────────────────────┐ │   │
│ │ │ 2.5 mg                       │ │   │
│ │ │ (xl, Semibold)               │ │   │
│ │ └──────────────────────────────┘ │   │
│ │ 11월 24일 (일)                    │   │
│ │ (base, Regular)                  │   │
│ │                                  │   │
│ │ [StatusBadge: 완료됨 ✓]           │   │
│ │                                  │   │
│ │ Action: 기록 버튼 (Primary)       │   │
│ └──────────────────────────────────┘   │
│                                         │
│ ┌──────────────────────────────────┐   │
│ │ [Next Card...]                   │   │
│ └──────────────────────────────────┘   │
│                                         │
├─────────────────────────────────────────┤
│ EmptyState (계획 없음)                   │
│                                         │
│        [Icon: 120x120px]                │
│                                         │
│    투여 계획이 없습니다                 │
│    (lg, Semibold)                      │
│                                         │
│  온보딩을 완료하여...                   │
│  (base, Regular)                       │
│                                         │
├─────────────────────────────────────────┤
│ DoseRecordDialog (Modal)                │
│                                         │
│ ┌─────────────────────────────────┐    │
│ │ 투여 기록              [닫기]    │    │
│ ├─────────────────────────────────┤    │
│ │ 2.5 mg를 투여했습니다.           │    │
│ │                                  │    │
│ │ 주사 부위                         │    │
│ │ [InjectionSiteSelectWidget]       │    │
│ │                                  │    │
│ │ 메모 (선택사항)                   │    │
│ │ [TextField]                       │    │
│ ├─────────────────────────────────┤    │
│ │ [취소]        [저장]            │    │
│ └─────────────────────────────────┘    │
│                                         │
└─────────────────────────────────────────┘
```

---

## Approval Required

- [ ] User approves improvement direction
- [ ] All Design System tokens available
- [ ] Dependencies acknowledged
