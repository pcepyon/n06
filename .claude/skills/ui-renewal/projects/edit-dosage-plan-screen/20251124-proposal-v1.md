# EditDosagePlanScreen 개선 제안서

## 개요
EditDosagePlanScreen을 Gabium 디자인 시스템에 맞춰 재설계합니다. 현재 화면은 Material Design 기본 스타일을 사용하고 있으며, 브랜드 일관성, 시각적 계층 구조, 데이터 가독성, 사용자 경험 측면에서 개선이 필요합니다.

**목표**: 활성 GLP-1 투여 계획 수정 화면을 신뢰감 있고 친근한 Gabium 브랜드 경험으로 변환

## 현재 상태 분석

### 브랜드 일관성 문제
- **AppBar**: Material Design 기본 AppBar 스타일, Gabium 색상 미적용
- **색상 팔레트**: Material Colors 기본값 사용 (빨강, 초록) - Gabium Primary (#4ADE80) 미적용
- **타이포그래피**: 하드코딩된 폰트 크기 (16px) - Gabium Type Scale 미사용 (base, sm, lg 등)
- **버튼**: ElevatedButton/TextButton Material 기본값 - GabiumButton 미사용
- **입력 필드**: DropdownButtonFormField 기본 OutlineInputBorder - Gabium TextField 스타일 미적용
- **알림**: SnackBar Material 색상 - GabiumToast 미사용

### 시각적 품질 문제
- **카드**: 테두리 스타일만 사용, shadow 없음 - Design System 카드 스타일(sm shadow) 미적용
- **간격**: 일관되지 않은 padding (16px, 12px, 32px) - Gabium Spacing Scale 미준수
- **포커스 상태**: OutlineInputBorder는 기본 회색 - Gabium focus state (#4ADE80 border) 미적용
- **비활성 상태**: 비활성 드롭다운 텍스트 색상이 불명확함
- **영향 분석 다이얼로그**: 심플한 AlertDialog - 모달 Design System 미적용

### UX 문제
- **투여 계획 변경 흐름**:
  - 사용자가 약물/용량/시작일 변경
  - "저장" 버튼 클릭
  - 영향 분석 다이얼로그 표시 (변경이 있을 때만)
  - 그러나 현재 구현에서 영향 분석이 충분히 시각화되지 않음

- **약물명 드롭다운**:
  - 선택 후 용량 드롭다운이 비활성되어 있음
  - 사용자에게 "약물을 먼저 선택하세요"는 피드백이 없음

- **투여 주기 표시**:
  - 읽기 전용 InputDecorator로 표시
  - 시각적으로는 입력 필드로 보이지만 수정 불가 - UX 혼동 가능성

- **시작일 선택**:
  - ListTile로 구현
  - 다른 입력 필드와 스타일이 일치하지 않음
  - 터치 영역이 명확하지 않음

- **저장 버튼**:
  - 전체 너비 ElevatedButton
  - 취소 액션이 없음 (back button 사용)
  - 로딩 상태 표시 없음

- **영향 분석 다이얼로그**:
  - 경고 메시지가 amber.shade100 배경 - Gabium Warning 색상 아님
  - 다이얼로그 스타일이 Design System 모달 가이드라인 미충족

## 개선 방향

### 변경 1: 브랜드 AppBar 적용
**현재**: Material Design 기본 AppBar
**제안**: Gabium Design System 기반 AppBar
- 배경: #FFFFFF (White)
- 제목: xl (20px, Semibold), Neutral-800 (#1E293B)
- 하단 테두리: 1px solid #E2E8F0 (Neutral-200)
- 뒤로 가기 버튼: 44x44px icon button

**근거**:
- 앱 전체 네비게이션 일관성 확보
- 신뢰감 있는 흰색 배경과 중립적인 테두리
- iOS/Android 표준 AppBar 높이 56px 유지

### 변경 2: GabiumButton으로 버튼 통일
**현재**: ElevatedButton, TextButton, AlertDialog 기본 버튼
**제안**:
- "저장" 버튼: GabiumButton (Primary variant, Large size)
- "취소" 버튼: GabiumButton (Secondary variant)
- 다이얼로그 액션: GabiumButton (Primary, Secondary)

**근거**:
- 전체 앱의 버튼 스타일 일관성
- Gabium Primary (#4ADE80) 브랜드 강화
- 로딩 상태, disabled 상태 자동 지원

### 변경 3: GabiumTextField 스타일 적용
**현재**: OutlineInputBorder 기본 스타일
**제안**: GabiumTextField 컴포넌트 또는 동일한 스타일 적용
- 높이: 48px
- 테두리: 2px solid #CBD5E1 (Neutral-300)
- 포커스: #4ADE80 border, 10% 배경
- 라벨: sm (14px, Semibold)
- 에러 상태: #EF4444 border

**근거**:
- 입력 필드 터치 영역 44px 이상 확보
- 포커스 시 Primary color로 명확한 피드백
- 라벨 스타일로 타이포그래피 계층 강화

### 변경 4: 드롭다운 UX 개선
**현재**:
- DropdownButtonFormField로 약물명/용량 선택
- 약물 미선택 시 용량 드롭다운 비활성 (명확한 피드백 없음)

**제안**:
- 드롭다운 스타일을 GabiumTextField 스타일로 통일
- 약물 미선택 시: 용량 필드 힌트 텍스트 "먼저 약물을 선택하세요" + disabled 상태 명확화
- 약물 선택 후: 용량 필드 활성화 + smooth animation
- 선택된 항목 시각화: 명확한 icon (checkmark)

### 변경 5: 투여 주기 표시 개선
**현재**: InputDecorator로 읽기 전용 표시
**제안**:
- 일반 텍스트 필드 스타일 유지 (border 포함)
- 배경: #F8FAFC (Neutral-50) - read-only 상태 표현
- 텍스트: #334155 (Neutral-700, 비활성 텍스트)
- 테두리: 1px solid #E2E8F0 (Neutral-200)
- 터치 불가 상태 명확히 (cursor: no-drop)

**근거**:
- 다른 입력 필드와 시각적 일관성 유지
- read-only 상태를 배경색으로 명확히 표현
- Design System read-only input 가이드라인 준수

### 변경 6: 시작일 선택 UX 개선
**현재**: ListTile로 구현, 다른 입력 필드와 불일치
**제안**:
- GabiumTextField 스타일의 컨테이너 사용
- 높이: 48px
- 아이콘: calendar_today 24px (right-aligned)
- 라벨: "시작일"
- 선택된 날짜: "2025-11-24" 형식
- 탭 시: showDatePicker 호출

**근거**:
- 모든 입력 필드가 일관된 높이/스타일 확보
- 터치 영역 44px 이상 명확화
- 다른 폼 필드와 시각적 계층 일치

### 변경 7: 영향 분석 다이얼로그 재설계
**현재**: AlertDialog에 amber.shade100 경고 박스
**제안**:
- Design System Modal/Dialog 가이드라인 적용
- 배경: 투명한 배경 + #FFFFFF 다이얼로그 컨테이너
- 테두리: 없음 (shadow로 elevation 표현)
- 최대 너비: 480px (mobile: 90% viewport)
- Border Radius: 16px (lg)
- Shadow: xl

**다이얼로그 구조**:
- 헤더: "투여 계획 변경" (xl, Bold), 닫기 버튼
- 바디:
  - 설명 텍스트: "투여 계획 변경 시 이후 스케줄이 재계산됩니다"
  - 영향 분석 섹션:
    - 영향받는 스케줄 수: "3개의 스케줄이 영향을 받습니다" (base, Neutral-600)
    - 변경되는 항목: 칩(Chip) 형태로 표시 (약물명, 용량, 시작일)
  - 경고 메시지 (있을 경우): Warning 색상 배경 (#FEF3C7 background, #B45309 text, 1px border #FDE68A)
- 푸터: 취소(Secondary), 확인(Primary) 버튼 (우측 정렬)

**근거**:
- Design System 다이얼로그 가이드라인 준수
- 영향 분석 정보를 구조화된 형태로 표현
- Gabium Warning 색상 (#F59E0B) 적용
- 최종 확인 전 충분한 정보 제공

### 변경 8: 색상 및 타이포그래피 통일
**현재**: Material Colors (빨강, 초록, 회색)
**제안**:
- Primary: #4ADE80 (모든 primary action)
- Error: #EF4444 (에러 메시지)
- Warning: #F59E0B (경고 메시지)
- Neutral palette: Slate 계열 사용
- 타이포그래피: Gabium Type Scale 준수
  - 제목: 2xl (24px, Bold)
  - 섹션 라벨: sm (14px, Semibold)
  - 본문: base (16px, Regular)
  - 보조 텍스트: xs (12px, Regular)

### 변경 9: 간격 시스템 정합성
**현재**: 일관되지 않은 padding (16px, 12px, 32px)
**제안**: Gabium Spacing Scale 준수
- 요소 간 간격: md (16px) 기본
- 섹션 간 간격: lg (24px)
- 바닥 여백: xl (32px)
- 하단 safe area: 추가 inset

## 예상 효과

### 사용자 경험
- ✅ 입력 필드 스타일 일관성으로 폼 완성도 향상
- ✅ 명확한 영향 분석 정보로 의사결정 신뢰도 증가
- ✅ Gabium 브랜드 색상으로 app identity 강화
- ✅ 개선된 터치 영역 (44px+) 모바일 사용성 향상

### 개발 효율성
- ✅ 기존 GabiumButton, GabiumTextField 등 재사용
- ✅ Design System tokens 활용으로 유지보수 용이성 증가
- ✅ 추후 브랜드 변경 시 centralized 변경

### 브랜드
- ✅ EditDosagePlanScreen이 Gabium Design System 준수
- ✅ 전체 앱의 일관된 visual identity 확보
- ✅ 의료 앱으로서 신뢰감 강화

## 구현 범위

### 수정 대상
- AppBar 재설계 (AppBar 스타일 또는 GabiumAppBar 컴포넌트 사용)
- DropdownButtonFormField → GabiumTextField 스타일 적용
- InputDecorator → 읽기 전용 입력 필드 스타일
- ListTile (시작일) → GabiumTextField 스타일 date picker
- ElevatedButton/TextButton → GabiumButton
- SnackBar → GabiumToast
- AlertDialog (영향 분석) → Gabium Modal 스타일
- 모든 색상/타이포그래피/간격 업데이트

### 신규 생성 컴포넌트 (필요시)
- DatePickerField: GabiumTextField 기반 날짜 선택 필드
- ImpactAnalysisDialog: 영향 분석 전용 다이얼로그

### 재사용 컴포넌트
- GabiumButton
- GabiumToast
- GabiumAppBar (또는 AppBar 스타일)

## 기술 스택
- Framework: Flutter
- Design System: Gabium v1.0
- Components: GabiumButton, GabiumTextField, GabiumToast, GabiumAppBar
- State Management: Riverpod (기존 유지)

## 검증 기준

1. ✅ 모든 버튼이 GabiumButton을 사용하는가?
2. ✅ 모든 입력 필드가 GabiumTextField 스타일을 따르는가?
3. ✅ 색상이 Gabium palette (#4ADE80, #EF4444, #F59E0B 등)을 사용하는가?
4. ✅ 타이포그래피가 Design System type scale을 준수하는가?
5. ✅ 간격(padding, margin)이 Spacing Scale (8px 기반)을 준수하는가?
6. ✅ 다이얼로그가 Design System modal 가이드라인을 따르는가?
7. ✅ 모든 interactive element가 44x44px 터치 영역을 확보하는가?
8. ✅ AppBar가 일관된 스타일을 사용하는가?
9. ✅ 에러/경고/성공 메시지가 semantic colors를 사용하는가?
10. ✅ 로딩/disabled 상태가 시각적으로 명확한가?

---

**문서 버전**: v1
**작성 날짜**: 2025-11-24
**상태**: Proposal Phase 완료, Implementation 단계 대기
