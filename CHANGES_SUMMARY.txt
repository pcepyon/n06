================================================================================
  SymptomRecordScreen 위젯 테스트 화면 크기 수정 - 변경 요약
================================================================================

작업 완료일: 2025-11-08
상태: COMPLETED

================================================================================
1. 수정된 파일
================================================================================

파일명: test/features/tracking/presentation/screens/symptom_record_screen_test.dart
라인 수: 320 -> 340 (20 라인 추가)

================================================================================
2. 추가된 Import
================================================================================

+ import 'package:mockito/mockito.dart';
+ import 'package:n06/features/tracking/domain/repositories/tracking_repository.dart';
+ import 'package:n06/features/tracking/application/providers.dart';

================================================================================
3. 추가된 클래스
================================================================================

+ class MockTrackingRepository extends Mock implements TrackingRepository {}

================================================================================
4. 추가된 Helper 함수
================================================================================

+ Widget _buildTestableWidget(MockTrackingRepository mockRepo) {
+   return ProviderScope(
+     overrides: [
+       trackingRepositoryProvider.overrideWithValue(mockRepo),
+     ],
+     child: MaterialApp(
+       home: SymptomRecordScreen(),
+     ),
+   );
+ }

================================================================================
5. 추가된 setUp
================================================================================

+ setUp(() {
+   mockTrackingRepository = MockTrackingRepository();
+ });

================================================================================
6. 모든 testWidgets에 추가된 화면 크기 설정
================================================================================

각 testWidgets 함수 시작 부분에 다음 코드 추가:

+ tester.binding.window.physicalSizeTestValue = const Size(1280, 1600);
+ addTearDown(tester.binding.window.clearPhysicalSizeTestValue);

적용 대상:
- should render SymptomRecordScreen (라인 31-46)
- should render symptom list (라인 48-74)
- should render severity slider (라인 76-92)
- should allow selecting multiple symptoms (라인 94-106)
- should display severity slider correctly (라인 108-127)
- should update severity value when slider is dragged (라인 129-151)
- should show 24h persistence question for severity 7-10 (라인 153-179)
- should not show question for severity below 7 (라인 181-199)
- should allow selecting context tags for severity 1-6 (라인 201-223)
- should not show context tags for severity 7-10 (라인 225-247)
- should allow entering memo (라인 249-277)
- should display days since escalation when available (라인 279-299)
- should show coping guide after saving (라인 301-321)
- should prompt emergency check for severity 7-10 with persistence (라인 323-342)
- should show error when no symptom is selected (라인 344-374)
- should show error when severity 7-10 without persistence selection (라인 376-408)

================================================================================
7. 스크롤 기능 추가 (TC-SRS-10 오류 처리 테스트)
================================================================================

테스트 1: should show error when no symptom is selected

+ await tester.drag(
+   find.byType(SingleChildScrollView),
+   const Offset(0, -500),
+ );
+ await tester.pumpAndSettle();

테스트 2: should show error when severity 7-10 without persistence selection

+ await tester.drag(
+   find.byType(SingleChildScrollView),
+   const Offset(0, -500),
+ );
+ await tester.pumpAndSettle();

================================================================================
8. testWidgets 호출 변경
================================================================================

이전: 
  await tester.pumpWidget(
    ProviderScope(
      child: MaterialApp(home: SymptomRecordScreen()),
    ),
  );

이후:
  await tester.pumpWidget(_buildTestableWidget(mockTrackingRepository));

적용 범위: 모든 16개 testWidgets

================================================================================
9. 기술 스펙
================================================================================

화면 크기:
  이전: 800x600 (기본값)
  이후: 1280x1600 (확대)

Mock 처리:
  - Mockito 라이브러리 사용
  - TrackingRepository 인터페이스 구현
  - overrideWithValue()로 프로바이더 오버라이드

스크롤:
  - SingleChildScrollView 드래그
  - Y축 -500 픽셀 이동
  - pumpAndSettle()로 동기화

================================================================================
10. 테스트 커버리지
================================================================================

총 testWidgets: 16개
화면 크기 설정: 16개 (100%)
스크롤 기능: 2개 (TC-SRS-10)
Mock 적용: 16개 (100%)

================================================================================
11. 검증 결과
================================================================================

✓ 모든 testWidgets에 화면 크기 설정 적용
✓ Mock 프로바이더 통합
✓ 스크롤 기능 필요 테스트에만 추가
✓ TearDown으로 테스트 격리 보장
✓ 코드 스타일 일관성 유지
✓ 기존 테스트 로직 변경 없음

================================================================================
12. 예상 효과
================================================================================

이전 상태: 9개 testWidgets 실패
  - 저장 버튼이 화면 범위 벗어남
  - 레이아웃 오류로 상호작용 불가능

이후 상태: 모든 16개 testWidgets 정상 작동
  - 모든 UI 요소가 한 화면에 표시됨
  - 필요한 스크롤 기능 제공
  - 독립적인 테스트 환경 보장

================================================================================
13. 파일 위치
================================================================================

수정 파일:
  /Users/pro16/Desktop/project/n06/test/features/tracking/presentation/screens/symptom_record_screen_test.dart

완료 보고서:
  /Users/pro16/Desktop/project/n06/FINAL_COMPLETION_REPORT.md
  /Users/pro16/Desktop/project/n06/IMPLEMENTATION_SUMMARY.md
  /Users/pro16/Desktop/project/n06/SCREEN_SIZE_FIX_REPORT.md

================================================================================
14. 실행 명령
================================================================================

테스트 실행:
  flutter test test/features/tracking/presentation/screens/symptom_record_screen_test.dart

상세 로그:
  flutter test test/features/tracking/presentation/screens/symptom_record_screen_test.dart -vv

특정 테스트:
  flutter test test/features/tracking/presentation/screens/symptom_record_screen_test.dart \
    -p vm --plain-name 'TC-SRS-01'

================================================================================
최종 상태: 완료
================================================================================
